" @Author: clouduan
" @Last Modified by: clouduan
" @Last Modified time: 2018-08-27
" @Description: Configuration for Neovim

" ======================================================================
" Preface
" ======================================================================
" [[[
" Sections:
"    -> Basic Settings
"    -> Key Mappings
"    -> Customized Functions
"    -> Load Plugin
"    -> Plugin Settings
" Todo:
"    -> GUI Settings...
"    -> works ç²¾ç®€
"    -> CR : ctrl -]
" ]]]

" ======================================================================
" Init
" ======================================================================
" [[[
let mapleader   = ';'
let g:mapleader = ';'
" use python35 instead of python37: imp module deprecated
set pythonthreedll=/e/Applications/Python35/python35.dll
" ]]]

" ======================================================================
" Load Plugins
" ======================================================================
" [[[
set runtimepath^=~/.vim runtimepath+=~/.vim/after
let &packpath = &runtimepath

call plug#begin('~/.vim/plugged')
" [[[ Languages && Completion
" [[[ Languages
" Cpp
Plug 'octol/vim-cpp-enhanced-highlight'
" Go
Plug 'fatih/vim-go',{'for':'go'}
" Markdown
Plug 'godlygeek/tabular'
Plug 'plasticboy/vim-markdown',{'for':'markdown'}
Plug 'iamcco/mathjax-support-for-mkdp',{'for':'markdown'}
Plug 'iamcco/markdown-preview.vim',{'for':'markdown'}
Plug 'dhruvasagar/vim-table-mode',{'for':'markdown'}
Plug 'xuhdev/SingleCompile'
" HTML
Plug 'rstacruz/sparkup', {'for':'html'}
Plug 'othree/html5.vim',{'for':'html'}
Plug 'mattn/emmet-vim',  {'for': ['html','vue','css']}
Plug 'alvan/vim-closetag', {'for': ['html', 'xml']}
Plug 'Valloric/MatchTagAlways',{'for':['xml','html']}
" JavaScript
" Plug 'pangloss/vim-javascript',{'for':'javascript'}
" Plug 'ternjs/tern_for_vim',{'for':'javascript','do':'npm install'}
" JSON
Plug 'elzr/vim-json',{'for':'json'}
" Wolfram
Plug 'rsmenon/vim-mathematica',{'for':'mma'}
" Plug 'clouduan-bot/test-wl',{'for':'mma'}
" ]]]

" " [[[ Deoplete
" if has('nvim')
"   Plug 'Shougo/deoplete.nvim', { 'do': ':UpdateRemotePlugins' }
" else " vim-hug-neovim-rpc doesn't work in vim-git bash
"   Plug 'Shougo/deoplete.nvim'
"   Plug 'roxma/nvim-yarp'
"   Plug 'roxma/vim-hug-neovim-rpc'
" endif
" Plug 'Shougo/neopairs.vim'
" Plug 'Shougo/echodoc.vim'
" " Plug 'autozimu/LanguageClient-neovim', {
" "     \ 'branch': 'next',
" "     \ 'do': 'bash install.sh',
" "     \ }

" " c/cpp source
" Plug 'zchee/deoplete-clang',{'for':['c','cpp']}

" " emoji source
" Plug 'fszymanski/deoplete-emoji',{'for':['markdown','gitcommit']}

" " gitcommit source
" " Plug 'SevereOverfl0w/deoplete-github',{'for':'gitcommit'}

" " go source
" Plug 'zchee/deoplete-go',{'for':'go'}

" " javascript source
" Plug 'carlitux/deoplete-ternjs', {'for':'javascript'}

" " python source
" " pip install jedi
" Plug 'zchee/deoplete-jedi',{'for':'python'}

" " tmux source
" Plug 'wellle/tmux-complete.vim'

" " typescript source
" " æœ‰é—®é¢˜
" " Plug 'HerringtonDarkholme/yats.vim'
" " Plug 'mhartington/nvim-typescript', {'for':'typescript'
" "             \ 'do':['./install.sh']}

" " vim source
" Plug 'Shougo/neco-vim',{'for':'vim'}

" " web browser source
" Plug 'thalesmello/webcomplete.vim'

" " zsh source
" Plug 'zchee/deoplete-zsh',{'for':['sh','zsh']}

" " Snippets
" Plug 'honza/vim-snippets'
" Plug 'sirver/ultisnips'
" " ]]]

" [[[ Complete on git bash: vim-hug-neovim-rpcç”±äº python34 ä¹‹å imp æ¨¡å—çš„åŸå› ä¸èƒ½åœ¨ vim8 ä¸Šä½¿ç”¨
    Plug 'vim-scripts/AutoComplPop'
    let g:acp_behaviorKeywordLength = 1
    let g:acp_behaviorPythonOmniLength = 1
" ]]]
" ]]]

" [[[ ColorScheme && Format && Display && Interface
" ColorScheme
Plug 'chxuan/change-colorscheme'
" å½©è™¹æ‹¬å·
Plug 'luochen1990/rainbow'
" CSS é¢œè‰²é«˜äº®
Plug 'ap/vim-css-color'
" æ ¼å¼åŒ–
Plug 'Chiel92/vim-autoformat'
Plug 'Yggdroot/indentLine'
" ç•Œé¢
Plug 'justinmk/vim-dirvish'
Plug 'scrooloose/nerdtree',{'on': ['NERDTreeFind','NERDTreeToggle']}
Plug 'Xuyuanp/nerdtree-git-plugin',{'on':['NERDTreeFind','NERDTreeToggle']}
Plug 'tiagofumo/vim-nerdtree-syntax-highlight'
Plug 'mhinz/vim-startify'
" æ²‰æµ¸æ¨¡å¼
Plug 'junegunn/goyo.vim'
" Statusline
Plug 'vim-airline/vim-airline'
Plug 'vim-airline/vim-airline-themes'
" å›¾æ ‡
Plug 'ryanoasis/vim-devicons'
" undotree å¯è§†åŒ–
Plug 'mbbill/undotree'
" mark å¯è§†åŒ–
Plug 'kshenoy/vim-signature'
" bookmarks
Plug 'mattesgroeger/vim-bookmarks'

Plug 'osyo-manga/vim-over'
" ]]]

" [[[ Integrations && Enhancements
" [[[ Git
" Git operators
Plug 'tpope/vim-fugitive'
" GitHub(fugitive Gbrose support)
Plug 'tpope/vim-rhubarb'
" Git commit
Plug 'junegunn/gv.vim'
" Git diff
Plug 'mhinz/vim-signify'
" Gist
Plug 'mattn/gist-vim'
Plug 'mattn/webapi-vim'
" Quick comment
Plug 'tpope/vim-commentary'
" ]]]

" [[[ Enhancements
" Syntax
Plug 'w0rp/ale'
" å¼‚æ­¥è¿è¡Œ
Plug 'skywind3000/asyncrun.vim'
" sudo
Plug 'chrisbra/sudoedit.vim'
" ctag
Plug 'ludovicchabant/vim-gutentags'
" fuzzy finder
Plug 'Yggdroot/LeaderF'
"Light web search
Plug 'clouduan/vim-searchme'
" ç¿»è¯‘
Plug 'ianva/vim-youdao-translater'
" File header
Plug 'alpertuna/vim-header'
" ç©ºç™½ç¬¦æç¤º
Plug 'ntpeters/vim-better-whitespace'
" Mark + é«˜äº®
Plug 'inkarkat/vim-mark'
Plug 'inkarkat/vim-ingo-library'
" ]]]

" [[[ Move
" å¢å¼ºè·³è½¬
Plug 'easymotion/vim-easymotion'
" å¢å¼ºåœ¨åŒ¹é…ç¬¦ä¹‹é—´çš„è·³è½¬ï¼Œæ¯” matchit æ›´å¼ºå¤§
Plug 'andymass/vim-matchup'
" äº¤æ¢å•è¯ç­‰
Plug 'tommcdo/vim-exchange'
" ç§»åŠ¨æ•´è¡Œ/å—
Plug 'matze/vim-move'
" å·¦å³ç§»åŠ¨å‡½æ•°å‚æ•°ã€åˆ—è¡¨å…ƒç´ ç­‰
Plug 'andrewradev/sideways.vim'
" ]]]

" [[[ Edit
" å¢å¼ºæ›¿æ¢åŠŸèƒ½ï¼Œ:S
Plug 'tpope/vim-abolish'
" å¢å¼ºæŒ‰é”®ï¼Œæ‰©å±•
Plug 'tpope/vim-unimpaired'
" å¢å¼ºæœç´¢ï¼Œå¿«é€Ÿæœç´¢å…‰æ ‡ä¸‹çš„è¯
Plug 'bronson/vim-visual-star-search'
" æˆå¯¹ç¬¦å·ç¼–è¾‘
Plug 'tpope/vim-surround'
" è®©ç‚¹èŒƒå¼(.)æ”¯æŒæ’ä»¶ä¸­çš„é”®æ˜ å°„ï¼Œç‰¹åˆ«æ˜¯å¯¹ vim-surround
Plug 'tpope/vim-repeat'
" åŒ…è£…å’Œè§£åŒ…åˆ—è¡¨ã€å­—å…¸ç­‰
Plug 'foosoft/vim-argwrap'
" è‡ªåŠ¨é—­åˆæ‹¬å·
Plug 'jiangmiao/auto-pairs'

" å¯¹é½
Plug 'junegunn/vim-easy-align'
" æ–‡æœ¬å¯¹è±¡ Text objects
Plug 'kana/vim-textobj-user'
Plug 'kana/vim-textobj-entire'
Plug 'kana/vim-textobj-line'
Plug 'kana/vim-textobj-lastpat'
Plug 'glts/vim-textobj-comment'
Plug 'jceb/vim-textobj-uri'
Plug 'reedes/vim-textobj-sentence'
Plug 'michaeljsmith/vim-indent-object'
Plug 'jeetsukumaran/vim-pythonsense'
Plug 'wellle/targets.vim'
Plug 'terryma/vim-multiple-cursors'
" ]]]
" ]]]

" [[[ Misc
" ä¸­æ–‡å¸®åŠ©æ–‡æ¡£
Plug 'yianwillis/vimcdoc'
" Plug 'skywind3000/vim-keysound'
" ]]]

call plug#end()
" ]]]

" ======================================================================
" Basic Settings
" ======================================================================
" [[[
" Generic [[[
set history=2000

" å…¼å®¹ Dirvish è€Œå…³é—­ï¼Œç”±åé¢å‡½æ•°å®ç°
set noautochdir
set modifiable

set autoread
set autowrite
set updatetime=5000
set nospell

set nobackup
set noswapfile
set nowritebackup
set undodir=~/.vim/.cache/undo_dir/
set undofile

" æ˜ å°„è¶…æ—¶å’Œé”®ç è¶…æ—¶
set timeout
set ttimeout
set timeoutlen=500
set ttimeoutlen=20

set mouse=a
set mousehide
set selectmode=mouse
" ä¸é€‚ç”¨ç³»ç»Ÿå‰ªåˆ‡æ¿ï¼Œç”± <Leader> ç»„åˆé”®å®ç°
set clipboard=

set backspace=2
set backspace=eol,start,indent

set whichwrap=b,s,h,l,<,>,[,]
" ]]]

" Display [[[
colorscheme gruvbox

set termguicolors

set background=dark
set t_Co=256

set title
set ruler
set showcmd
set cursorline
set laststatus=2
set shortmess+=c

set scrolloff=6
set wrap
" ä¸è®¾ç½®è‡ªåŠ¨æŠ˜è¡Œ
set textwidth=1000
" è®¾ç½®æç¤ºçº¿
" set colorcolumn=100

set showmatch
set matchtime=1
set matchpairs+=<:>
set matchpairs+=ã€Š:ã€‹
set matchpairs+=ï¼ˆ:ï¼‰
set matchpairs+=ã€:ã€‘
set matchpairs+=â€œ:â€
set matchpairs+=â€˜:â€™

set hlsearch
set incsearch
set wrapscan
set ignorecase
set smartcase

set foldlevel=99

set autoindent
set smartindent

" tab -> space
set tabstop=4
set shiftwidth=4
set softtabstop=4
set smarttab
set expandtab
set shiftround

set relativenumber number

set lazyredraw
" ]]]

" Files [[[
set isfname-==
" è®¾ç½®æ–°æ–‡ä»¶çš„ç¼–ç ä¸º UTF-8
set encoding=utf-8
" è‡ªåŠ¨åˆ¤æ–­ç¼–ç æ—¶ï¼Œä¾æ¬¡å°è¯•ä»¥ä¸‹ç¼–ç ï¼š
set fileencodings=utf-8,cp936,gb18030,big5,euc-jp,euc-kr,latin1
" ä½¿ç”¨Unixæ–‡ä»¶æ ¼å¼
set fileformats=unix,dos,mac
" å¦‚é‡Unicodeå€¼å¤§äº255çš„æ–‡æœ¬ï¼Œä¸å¿…ç­‰åˆ°ç©ºæ ¼å†æŠ˜è¡Œ
set formatoptions+=m
" åˆå¹¶ä¸¤è¡Œä¸­æ–‡æ—¶ï¼Œä¸åœ¨ä¸­é—´åŠ ç©ºæ ¼
set formatoptions+=B
" ç¦æ­¢è‡ªåŠ¨åŠ æ³¨é‡Šç¬¦å·
set formatoptions-=r
set formatoptions-=c
set formatoptions-=o
" ä½¿ç”¨åè¿›åˆ¶
set nrformats=
" è‡ªåŠ¨ä¿å­˜æ–‡ä»¶æ”¹åŠ¨è·³è½¬å…¶ä»–æ–‡ä»¶
set hidden
" å‘½ä»¤è¡Œæ–‡ä»¶åå¿½ç•¥å¤§å°å†™
set fileignorecase
" ]]]

" Others [[[
set completeopt=noinsert,longest

" å‘½ä»¤è¡Œä½¿ç”¨tabæ—¶æ˜¾ç¤ºå•è¡Œè¡¥å…¨èœå•
set wildmenu
set wildmode=longest,full
" å‘½ä»¤è¡Œè¡¥å…¨æ–‡ä»¶å/ç›®å½•ç­‰å¿½ç•¥å¤§å°å†™
set wildignorecase
set wildignore+=.stversions,*.pyc,*.spl,*.o,*.out,*~,%*
set wildignore+=*.jpg,*.jpeg,*.png,*.gif,*.zip,**/tmp/**,*.DS_Store
set wildignore+=__pycache__,*.egg-info
" ctags, I use gutentags
set tags=./.tags;,.tags
" å­—å…¸è¡¥å…¨
" set dictionary+=~/.vim/dict/words.txt
set dictionary+=~/.vim/dict/user_defined_words.txt
" ]]]
" ]]]

" ======================================================================
" Key Mappings
" ======================================================================
" [[[
" ç¦ç”¨ "Entering ex mode"
nnoremap Q <Nop>
" ç¦ç”¨ <CR> å‘ä¸‹ä¸€è¡Œçš„åŠŸèƒ½ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä½¿ <Leader>w<CR> å¿«é€Ÿä¿å­˜æ—¶é˜²æ­¢å…‰æ ‡è·³åˆ°ä¸‹ä¸€è¡Œ
" https://vi.stackexchange.com/questions/3127/how-to-map-enter-to-custom-command-except-in-quick-fix
noremap <silent> <expr> <CR> &buftype ==# 'quickfix' ? "\<CR>" : '\<Nop>'
noremap <F4> :redraw!<CR>

" è¡Œé¦–å’Œè¡Œæœ«å¿«æ·é”®
noremap H ^
noremap L $
" jj æ›¿æ¢ Esc
inoremap jj <Esc>
" U ä¸º redo
noremap U <C-r>
" è·³è½¬æ ‡è®°æ›´æ–¹ä¾¿
noremap ' `

" C-j è·³è½¬å‡½æ•°å®šä¹‰
noremap <C-j> <C-]>
" C-k è·³è½¬å¸®åŠ©
noremap <C-k> K

" å¹³æ»‘æ»šå±
noremap <C-U> <C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y>
noremap <C-D> <C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E>
" æŸ¥æ‰¾æ—¶å°†ç»“æœç½®äºå±å¹•ä¸­å¤®
nnoremap <silent> n nzz
nnoremap <silent> N Nzz
nnoremap <silent> * *zz
nnoremap <silent> # #zz
nnoremap <silent> g* g*zz

" ç¼–è¾‘ vimrc
noremap <Leader>ve :edit   ~/.vimrc<CR>
" source vimrc
noremap <Leader>vs :source ~/.vimrc<CR>

" æœç´¢ä½¿ç”¨æ¨¡å¼åŒ¹é…
noremap / /\v

" åˆ‡æ¢ buffer
noremap <silent> gn      :bnext<CR>
noremap <silent> gp      :bprev<CR>
noremap <silent> <S-Tab> :bnext<CR>
noremap <Leader>1 :1b<CR>
noremap <Leader>2 :2b<CR>
noremap <Leader>3 :3b<CR>
noremap <Leader>4 :4b<CR>
noremap <Leader>5 :5b<CR>
noremap <Leader>6 :6b<CR>
noremap <Leader>7 :7b<CR>
noremap <Leader>8 :8b<CR>
noremap <Leader>9 :9b<CR>
" åˆ é™¤å½“å‰ buffer
noremap <silent> <Leader>d :bd!<CR>

" åˆ‡æ¢çª—å£
noremap <M-h> <Esc><C-w>h
noremap <M-j> <Esc><C-w>j
noremap <M-k> <Esc><C-w>k
noremap <M-l> <Esc><C-w>l
" è°ƒæ•´çª—å£å¤§å°
noremap <M-up>    <C-w>+
noremap <M-down>  <C-w>-
noremap <M-left>  <C-w>10<
noremap <M-right> <C-w>10>

" æ–°å»º tab  Ctrl+T
noremap  <C-t>     <Esc>:tabnew<CR>
noremap! <C-t>     <Esc>:tabnew<CR>

" è°ƒæ•´ç¼©è¿›åè‡ªåŠ¨é€‰ä¸­
vnoremap < <gv
vnoremap > >gv
nnoremap < V<
nnoremap > V>

" å°†é€‰ä¸­æ–‡æœ¬å—å¤åˆ¶è‡³ç³»ç»Ÿå‰ªè´´æ¿
nnoremap <Leader>y "+yy
vnoremap <Leader>y "+y
nnoremap <Leader>Y "+y$
" è®¾ç½®å¿«æ·é”®å°†ç³»ç»Ÿå‰ªè´´æ¿å†…å®¹ç²˜è´´è‡³ vim
nnoremap <Leader>p "+p
nnoremap <Leader>P "+P
" å¤åˆ¶å½“å‰åˆ°è¡Œå°¾
nnoremap Y y$

" é€‰ä¸­
noremap <silent> <C-a> <Esc>ggVG
noremap <silent> <Leader>sa <Esc>ggVG
" æ‹·è´
vnoremap <silent> <C-c> "+y
" ä¿å­˜
nnoremap <silent> <C-s> :update<CR>
inoremap <silent> <C-s> <ESC>:update<CR>
vnoremap <silent> <C-s> <ESC>:update<CR>
" æ’å…¥æ¨¡å¼ä¸‹çš„å·¦å³ç§»åŠ¨
inoremap <C-k> <Esc>ka
inoremap <C-j> <Esc>ja
inoremap <C-h> <Esc>ha
inoremap <C-l> <Esc>la
" è¯é¦–è¯å°¾: forward; bachward
inoremap <C-b> <Esc>bi
inoremap <C-f> <Esc>ea
" è¡Œé¦–è¡Œå°¾:
inoremap <C-a> <Home>
inoremap <C-e> <End>
" æ–°å¼€ä¸€è¡Œ
inoremap <C-o> <Esc>o
" å¾€ä¸‹æ’å…¥ç©ºè¡Œ
inoremap <M-o> <Esc>O
" åˆ é™¤æ•´è¡Œ
inoremap <C-d> <Esc>ddi
" æ¸…é™¤æ•´è¡Œ
inoremap <C-u> <Esc>cc
" åˆ é™¤å½“å‰åˆ°è¡Œå°¾
inoremap <C-c> <Esc>C

" å¿«é€Ÿé€€å‡º
noremap <Leader>q  <Esc>:q<CR>
" å¿«é€Ÿä¿å­˜é€€å‡º
noremap <Leader>wq <Esc>:wq<CR>
" å¿«é€Ÿé€€ä¸åšä»»ä½•ä¿å­˜
noremap <Leader>Q  <Esc>:qa!<CR>
" å¿«é€Ÿä¿å­˜
noremap <Leader>w  <Esc>:w<CR>
" å¿«é€Ÿ grep TODO:å¼‚æ­¥
" noremap <Leader>gg :silent execute "AsyncRun grep -R " . shellescape(expand("<cWORD>")) . " ."<CR>:copen<CR>
noremap <Leader>gg :silent execute "grep -R " . shellescape(expand("<cWORD>")) . " ."<CR>:copen<CR>

" å‘½ä»¤è¡Œæ¨¡å¼å¢å¼º
" Ctrl-a åˆ°è¡Œé¦–ï¼Œ-e åˆ°è¡Œå°¾
cnoremap <C-a> <Home>
cnoremap <C-e> <End>
" å›æº¯å†å²å‘½ä»¤æ—¶ç”¨ C-p å’Œ C-n è¾¾åˆ°åƒ Up Down ä¸€æ ·çš„è¿‡æ»¤æ•ˆæœ
cnoremap <C-p> <Up>
cnoremap <C-n> <Down>
" å‰è¿›åé€€ä¸€ä¸ªå•è¯
cnoremap <C-b> <S-Left>
cnoremap <C-f> <S-Right>

" ç»ˆç«¯æ¨¡å¼
tnoremap <Esc>  <C-\><C-n>
" ç»ˆç«¯æ‰“å¼€
noremap <silent> <Leader><Space> <Esc>:term<CR>

" å®‰è£…ã€æ›´æ–°ã€åˆ é™¤æ’ä»¶
nnoremap <Leader><Leader>i :PlugInstall<CR>
nnoremap <Leader><Leader>u :PlugUpdate<CR>
nnoremap <Leader><Leader>c :PlugClean<CR>
command! PU PlugUpdate | PlugUpgrade
command! PS PlugStatus
command! PC PlugClean
" ]]]

" ======================================================================
" Custom Functions
" ======================================================================
" [[[

" ä¿å­˜ vimrc æ—¶è‡ªåŠ¨ source
augroup source_vimrc
    autocmd!
    autocmd BufWritePost ~/.vimrc nested source $MYVIMRC
augroup END

" ä¸åŒæ¨¡å¼è¡Œå·æ˜¾ç¤º
augroup line_number
    autocmd!
    autocmd InsertEnter * :set norelativenumber number
    autocmd InsertLeave * :set relativenumber
augroup END

" ç»ˆç«¯çª—å£å¤§å°å˜åŒ–æ—¶ä¿æŒæ‰€æœ‰çª—å£åŒç­‰å¤§å°
augroup equal_window_size
    autocmd!
    autocmd VimResized * exec "normal \<c-w>="
augroup END

augroup last_pos
    " æ‰“å¼€è‡ªåŠ¨å®šä½åˆ°æœ€åç¼–è¾‘çš„ä½ç½®, éœ€è¦ç¡®è®¤ .viminfo å½“å‰ç”¨æˆ·å¯å†™
    autocmd BufReadPost * if line("'\"") > 1 && line("'\"") <= line("$") | exe "normal! g'\"" | endif
augroup END

" æ‰“å¼€å¸®åŠ©æ–‡æ¡£æ—¶ï¼Œåœ¨çª—å£å·¦è¾¹ç«–ç›´æ‰“å¼€
augroup open_help
    autocmd!
    autocmd BufEnter */doc/* if &filetype=='help' | wincmd H | endif
    " æ²¡å¿…è¦è¿™ä¹ˆåšäº†ï¼Œå¤ª hack äº†
    " command! -nargs=* -complete=help H vertical leftabove help <args>
    " å½“å†æ‰“å¼€æ—¶ä¼šå¤±æ•ˆï¼Œä»ä¼šæ°´å¹³æ‰“å¼€ï¼Œåœ¨ ftplugin ä¹Ÿæ˜¯å¦‚æ­¤
    " autocmd FileType help wincmd H
augroup END

" è‡ªåŠ¨è¿›å…¥å½“å‰æ–‡ä»¶çš„ç›®å½•ï¼Œæ›´å¥½æ»´ä½¿ç”¨ NERDTree
augroup auto_ch_dir
    autocmd!
    autocmd BufEnter * silent! lcd %:p:h
augroup END

" å…³é”®è¯é«˜äº®
augroup syntax_highlight
    autocmd!
    autocmd Syntax * call matchadd('Todo',  '\W\zs\(TODO\|Todo\|todo\|FIXME\|CHANGED\|DONE\|XXX\|BUG\|HACK\)')
    autocmd Syntax * call matchadd('Debug', '\W\zs\(NOTE\|INFO\|IDEA\|NOTICE\)')
augroup END

" ä¸ªäºº gitignore é»˜è®¤é…ç½®
autocmd BufNewFile *.gitignore exec "call InitGitignore()"
function! InitGitignore()
    let s:ignore = ['################################################################',
                \ ' Generated by Vim function: InitGitignore',
                \ '.tags', '.idea/', '/.idea', '__pycache__', '*.pyc', '*.o', '*.out',
                \ 'build/',
                \ '################################################################']
    let s:lines = line('$')
    normal O
    call append(0, s:ignore)
endfunction

" ä¸€é”®è¿è¡Œ
noremap  <silent> <F5> <Esc>:call QuickRun()<CR>
noremap! <silent> <F5> <Esc>:call QuickRun()<CR>
function! QuickRun()
    exec 'w'
    if &filetype == 'c'
        exec "AsyncRun gcc % -o %<; ./%<"
        " æ‰§è¡Œåèšç„¦ Quickfix çª—å£
        " exec "AsyncRun gcc % -o %<; ./%<" | wincmd p
    elseif &filetype == 'cpp'
        exec "AsyncRun g++ % -o %<; ./%<"
    elseif &filetype == 'java'
        exec "AsyncRun javac %; java %<"
    elseif &filetype == 'sh'
        exec "AsyncRun bash %"
    elseif &filetype == 'python'
        exec "AsyncRun python %"
    elseif &filetype == 'html' || &filetype == 'htmldjango'
        exec "BrowserOpen " . expand("%:p")
    elseif &filetype == 'go'
        exec "AsyncRun go run %"
    elseif &filetype == 'markdown'
        exec "MarkdownPreview"
    endif
endfunction
command! -nargs=+ BrowserOpen call BrowserOpen(<q-args>)
function! BrowserOpen(obj)
    " windows(mingw)
    if has('win32') || has('win64') || has('win32unix')
        let cmd = 'start rundll32 url.dll,FileProtocolHandler ' . a:obj
    elseif has('mac') || has('macunix') || has('gui_macvim') || system('uname') =~? '^darwin'
        let cmd = 'open' . a:obj
    elseif executable('xdg-open')
        let cmd = 'xdg-open ' . a:obj
    else
        echoerr "No browser path found, please contact the developer."
    endif

    if exists('*jobstart')
        call jobstart(cmd)
    elseif exists('*job_start')
        call job_start(cmd)
    else
        call system(cmd)
    endif
endfunction

" æ•è· Ex å‘½ä»¤çš„è¾“å‡º
command! -nargs=+ -complete=command TabMessage call TabMessage(<q-args>)
function! TabMessage(cmd)
  redir => message
  silent execute a:cmd
  redir END
  if empty(message)
    echoerr "no output"
  else
    new
    setlocal buftype=nofile bufhidden=wipe noswapfile nobuflisted nomodified
    silent put=message
  endif
endfunction
" ]]]

" ======================================================================
" Plugin Settings
" ======================================================================
" [[[
" airline
" [[[
let g:airline_left_sep = 'î‚°'
let g:airline_left_alt_sep = 'î‚±'
let g:airline_right_sep = 'î‚²'
let g:airline_right_alt_sep = 'î‚³'
let g:airline_powerline_fonts = 1
let g:airline_theme = 'aurora'
" let g:airline_theme = 'base16_spacemacs'
" let g:airline_theme = 'cool'
" let g:airline_theme = 'light'
"
" buffer ç¼–å·æ˜¾ç¤º
let g:airline#extensions#tabline#buffer_nr_show = 1
" tab ç¼–å·æ˜¾ç¤º
" let g:airline#extensions#tabline#show_tab_nr = 1
let g:airline#extensions#tabline#enabled = 1
let g:airline#extensions#tabline#left_sep = 'î‚°'
let g:airline#extensions#tabline#left_alt_sep = 'î‚±'
let g:airline#extensioin#tabline#right_sep = 'î‚²'
let g:airline#extensioin#tabline#right_alt_sep = 'î‚³'
let g:airline#extensions#tabline#formatter = 'unique_tail'
" ]]]

" ale
" [[[
noremap <C-up>   <Plug>(ale_previous_wrap)
noremap <C-down> <Plug>(ale_next_wrap)
let g:ale_set_highlights = 0
let g:ale_sign_error = 'ğŸ¤•'
let g:ale_sign_warning = 'ğŸ¤”'
let g:ale_sign_column_always = 1
let g:ale_warn_about_trailing_whitespace = 0
let g:ale_maximum_file_size = 1024 * 1024
let g:ale_completion_enabled = 0
" å’Œ airline é›†æˆ
let g:airline#extensions#ale#enabled = 1
let airline#extensions#ale#error_symbol = '>>:'
let airline#extensions#ale#warning_symbol = '>:'
" æ˜¾ç¤ºæ¶ˆæ¯
let g:ale_echo_msg_error_str = 'E'
let g:ale_echo_msg_warning_str = 'W'
let g:ale_echo_msg_format = '[%linter%] %s [%severity%]'
" lint
let g:ale_lint_on_text_changed = 'never'
let g:ale_lint_on_insert_leave = 1
let g:ale_lint_on_enter = 1
let g:ale_lint_on_save = 1

" ALEFix seems cannot works, while vim-autoformat works...
let g:ale_fixers = {
            \ 'python': ['add_blank_lines_for_python_control_statements','autopep8','yapf','isort','remove_trailing_lines','trim_whitespace'],
            \ 'javascript': ['prettier', 'eslint','remove_trailing_lines','trim_whitespace'],
            \ 'c':['clang-format','remove_trailing_lines','trim_whitespace'],
            \ 'cpp':['clang-format','remove_trailing_lines','trim_whitespace'],
            \}
" Fix when saving Bug:some bugs for me...
" let g:ale_fix_on_save = 1
" ]]]

" AsyncRun
" [[[
" è‡ªåŠ¨æ‰“å¼€ quickfix window ï¼Œé«˜åº¦ä¸º 10
let g:asyncrun_open = 8
" ä»»åŠ¡ç»“æŸæ—¶å€™å“é“ƒæé†’
let g:asyncrun_bell = 1
" è®¾ç½® F12 æ‰“å¼€/å…³é—­ Quickfix çª—å£
nnoremap <F12> :call asyncrun#quickfix_toggle(8)<CR>
" ]]]

" auto-pairs
" [[[
let g:AutoPairs = {'(':')', '[':']', '{':'}',"'":"'",'"':'"', '`':'`', '<':'>','ï¼ˆ':'ï¼‰','ã€Š':'ã€‹','â€˜':'â€™','â€œ':'â€'}
autocmd FileType python let b:AutoPairs = {'(':')', '[':']', '{':'}',"'":"'",'"':'"', '`':'`', 'ï¼ˆ':'ï¼‰','ã€Š':'ã€‹','â€˜':'â€™','â€œ':'â€'}
autocmd FileType markdown let b:AutoPairs ={'(':')', '[':']', '{':'}',"'":"'",'"':'"', '`':'`', '<':'>','ï¼ˆ':'ï¼‰','ã€Š':'ã€‹','â€˜':'â€™','â€œ':'â€','*':'*','~':'~'}
" é˜²æ­¢ C-h è¢«æ˜ å°„ä¸º <BS>
let g:AutoPairsMapCh = 0
let g:AutoPairsMapSpace = 0
" Alt-e å¿«é€ŸåŠ æ‹¬å·
let g:AutoPairsShortcutFastWrap = '<M-e>'
" Alt-p å¼€å…³æ’ä»¶
let g:AutoPairsShortcutToggle = '<M-p>'
" è§£é™¤ä¸€ç³»åˆ—æ˜ å°„é”®
let g:AutoPairsShortcutJump = 'Disable'
let g:AutoPairsShortcutBackInsert = 'Disable'
let g:AutoPairsMapCR = 'Disable'
" ]]]

" change-colorscheme
" [[[
noremap  <silent> <F10> <Esc>:NextColorScheme<CR>
noremap! <silent> <F10> <Esc>:NextColorScheme<CR>
noremap  <silent> <F9>  <Esc>:PreviousColorScheme<CR>
noremap! <silent> <F9>  <Esc>:PreviousColorScheme<CR>
" ]]]

" deoplete.nvim
"" [[[
"" å› ä¸ºè¦ä½¿ç”¨ snippets è€Œå…³é—­ tab è¡¥å…¨
"" inoremap <silent><expr><tab> pumvisible() ? "\<c-n>" : "\<tab>"
"let g:deoplete#enable_at_startup = 0
"autocmd InsertEnter * call deoplete#enable()
"autocmd CompleteDone * silent! pclose!
"" é€‰é¡¹è®¾ç½®
"call deoplete#custom#option({
"            \ 'auto_complete_delay':0,
"            \ 'ignorecase':v:true,
"            \ 'smart_case':v:true,
"            \ 'auto_refresh_delay':10,
"            \ 'min_pattern_length':1
"            \ })

"" rank
"call deoplete#custom#source('file',          'rank', 1000)
"call deoplete#custom#source('buffer',        'rank', 900)
"call deoplete#custom#source('around',        'rank', 800)
"call deoplete#custom#source('go',            'rank', 650)
"call deoplete#custom#source('vim',           'rank', 640)
"call deoplete#custom#source('flow',          'rank', 630)
"call deoplete#custom#source('TernJS',        'rank', 620)
"call deoplete#custom#source('jedi',          'rank', 610)
"call deoplete#custom#source('omni',          'rank', 600)
"call deoplete#custom#source('ultisnips',     'rank', 510)
"call deoplete#custom#source('member',        'rank', 500)
"call deoplete#custom#source('tag',           'rank', 400)
"call deoplete#custom#source('tmux-complete', 'rank', 350)
"call deoplete#custom#source('dictionary',    'rank', 300)
"call deoplete#custom#source('syntax',        'rank', 200)

"" omni
"call deoplete#custom#source('omni', 'functions', {
"		    \ 'ruby':  'rubycomplete#Complete',
"		    \ 'javascript': ['tern#Complete', 'jspc#omni']
"		    \})
"call deoplete#custom#var('omni', 'input_patterns', {
"            \ 'ruby': ['[^. *\t]\.\w*', '[a-zA-Z_]\w*::'],
"            \ 'java': '[^. *\t]\.\w*',
"            \ 'php': '\w+|[^. \t]->\w*|\w+::\w*',
"            \})

"" c/cpp è¡¥å…¨
"let g:deoplete#sources#clang#libclang_path = ''
"let g:deoplete#sources#clang#clang_header = ''

"" dict è¡¥å…¨
"" setlocal dictionary+=~/.vim/dict/words.txt
"setlocal dictionary+=~/.vim/dict/user_defined_words.txt
"call deoplete#custom#source('dictionary', 'matchers', ['matcher_head'])
"call deoplete#custom#source('dictionary', 'sorters', [])
"call deoplete#custom#source('dictionary', 'min_pattern_length', 4)

"" snippets è¡¥å…¨
"call deoplete#custom#source('ultisnips', 'rank', 300)

"" neopairs.vim
"call deoplete#custom#source('_', 'converters', ['converter_auto_paren'])

"" echodoc.vim
"set noshowmode
"let g:echodoc_enable_at_startup = 1
"let g:echodoc_type = 'echo'

"" github gitcommit
"" todo
"" call deoplete#custom#source('omni', 'functions',{
""             \ 'gitcommit': 'github'
""             \ })
"" call deoplete#custom#var('omni','input_patterns',{
""             \ 'gitcommit': '[^ \t]+'
""             \ })


"" tmux-complete.vim
"let g:tmuxcomplete#trigger = ''

"" webcomplete
"" Use <C-X><C-U> in insert mode to get completions
"set completefunc=webcomplete#complete
"" Use <C-X><C-O> in insert mode to get completions
"set omnifunc=webcomplete#complete

"" zsh è¡¥å…¨
"call deoplete#custom#source('zsh', 'filetypes', ['zsh', 'sh'])

"" è§£å†³å’Œ vim-multiple-cursor çš„å†²çª
"function! g:Multiple_cursors_before()
"    call deoplete#custom#buffer_option('auto_complete', v:false)
"endfunction
"function! g:Multiple_cursors_after()
"    call deoplete#custom#buffer_option('auto_complete', v:true)
"endfunction

"" javascript
"" [[[
"" Set bin if you have many instalations
"let g:deoplete#sources#ternjs#tern_bin = '~/.nvm/versions/node/v8.11.1/bin/'
"let g:deoplete#sources#ternjs#timeout = 1

"" Whether to include the types of the completions in the result data. Default: 0
"let g:deoplete#sources#ternjs#types = 1

"" Whether to include the distance (in scopes for variables, in prototypes for
"" properties) between the completions and the origin position in the result
"" data. Default: 0
"let g:deoplete#sources#ternjs#depths = 1

"" Whether to include documentation strings (if found) in the result data.
"" Default: 0
"let g:deoplete#sources#ternjs#docs = 1

"" When on, only completions that match the current word at the given point will
"" be returned. Turn this off to get all results, so that you can filter on the
"" client side. Default: 1
"let g:deoplete#sources#ternjs#filter = 0

"" Whether to use a case-insensitive compare between the current word and
"" potential completions. Default 0
"let g:deoplete#sources#ternjs#case_insensitive = 1

"" When completing a property and no completions are found, Tern will use some
"" heuristics to try and return some properties anyway. Set this to 0 to
"" turn that off. Default: 1
"let g:deoplete#sources#ternjs#guess = 0

"" Determines whether the result set will be sorted. Default: 1
"let g:deoplete#sources#ternjs#sort = 0

"" When disabled, only the text before the given position is considered part of
"" the word. When enabled (the default), the whole variable name that the cursor
"" is on will be included. Default: 1
"let g:deoplete#sources#ternjs#expand_word_forward = 0

"" Whether to ignore the properties of Object.prototype unless they have been
"" spelled out by at least two characters. Default: 1
"let g:deoplete#sources#ternjs#omit_object_prototype = 0

"" Whether to include JavaScript keywords when completing something that is not
"" a property. Default: 0
"let g:deoplete#sources#ternjs#include_keywords = 1

"" If completions should be returned when inside a literal. Default: 1
"let g:deoplete#sources#ternjs#in_literal = 0

""Add extra filetypes
"let g:deoplete#sources#ternjs#filetypes = [
"            \ 'jsx',
"            \ 'javascript.jsx',
"            \ 'vue'
"            \ ]
"" ]]]
"" ]]]


" fileheader
" " [[[
" let g:fileheader_auto_add = 0
" let g:fileheader_auto_update = 1
" let g:fileheader_default_author='clouduan'
" let g:fileheader_default_email = 'dyzplus@gmail'
" let g:fileheader_show_email = 0
" let g:fileheader_last_modified_by = 1
" let g:fileheader_last_modified_time = 1
" let g:fileheader_timestamp_format = '%Y-%m-%d'
" " ä¸æ–°å¼€ä¸€è¡Œï¼Œç›´æ¥æŒ‰ o å¼€å§‹æ–°è¡Œé¡ºæ‰‹
" let g:fileheader_new_line_at_end = 0
" " ]]]

" goyo.vim
" [[[
noremap <Leader>gy :Goyo<CR>
let g:goyo_width = '85'
let g:goyo_height = '85%'
let g:goyo_linenr = 1
" ]]]

" gv.vim
" [[[
noremap <Leader>gv :GV<CR>
" ]]]

" indentLine
" [[[
let g:indentLine_enabled = 1
let g:indentLine_color_term = 238
" ]]]

" LeaderF
" [[[
noremap <Leader>ff <Esc>:LeaderfFile<CR>
noremap <Leader>ft <Esc>:LeaderfBufTagAll<CR>
noremap <Leader>fb <Esc>:LeaderfBufferAll<CR>

let g:Lf_StlSeparator = {'left': '', 'right': '', 'font': ''}
let g:Lf_RootMarkers = ['.project', '.root', '.svn', '.git']
let g:Lf_MruFileExclude = ['*.so','*.py[c0]','*.exe','*.sw?']
let g:Lf_WildIgnore = {
            \ 'dir': ['.svn','.git','.hg','.cache','.idea','.android'],
            \ 'file': ['*.sw?','~$*','*.exe','*.o','*.so','*.py[co]']
            \}
let g:Lf_WorkingDirectoryMode = 'Ac'
let g:Lf_WindowHeight = 0.30
let g:Lf_CacheDirectory = expand('~/.vim/.cache')
let g:Lf_ShowRelativePath = 1
let g:Lf_HideHelp = 1
let g:Lf_ShowHidden = 1
let g:Lf_PreviewResult = {'Function':0, 'BufTag':0}
let g:Lf_IndexTimeLimit = 10
let g:Lf_Ctags = "/usr/local/bin/ctags"
" let g:Lf_PreviewCode = 1
let g:Lf_StlColorscheme = 'powerline'
let g:Lf_StlSeparator = {'left': 'î‚°', 'right': 'î‚²', 'font': ''}
" ]]]

" NERDTree
" [[[
" æ˜¾ç¤ºè¡Œå·
let NERDTreeShowLineNumbers = 1
let NERDTreeAutoCenter = 1
" æ˜¯å¦æ˜¾ç¤ºéšè—æ–‡ä»¶
let NERDTreeShowHidden = 0
" è®¾ç½®å®½åº¦
let NERDTreeWinSize = 28
" åœ¨ç»ˆç«¯å¯åŠ¨vimæ—¶ï¼Œå…±äº«NERDTree
let g:nerdtree_tabs_open_on_console_startup = 1
" å¿½ç•¥ä»¥ä¸‹æ–‡ä»¶çš„æ˜¾ç¤º
let NERDTreeIgnore = [
            \ '\.git$', '\.hg$', '\.svn$', '\.stversions$', '\.pyc$', '\.svn$','\~$',
	        \ '\.DS_Store$', '\.sass-cache$', '__pycache__$', '\.egg-info$', '\.cache$'
	        \ ]
" æ˜¾ç¤ºä¹¦ç­¾åˆ—è¡¨
let NERDTreeShowBookmarks = 1
" æ–‡ä»¶å‰é¢çš„æ ‡å¿—ç¬¦å·"
let g:NERDTreeDirArrowExpandable = 'â–¸'
let g:NERDTreeDirArrowCollapsible = 'â–¾'
" æ‰“å¼€ç›®å½•æ—¶è‡ªåŠ¨æ‰“å¼€ NERDTree
autocmd StdinReadPre * let s:std_in = 1
autocmd VimEnter * if argc() == 1 && isdirectory(argv()[0]) && !exists("s:std_in") | exe 'NERDTree' argv()[0] | wincmd p | ene | endif
" å¦‚æœåªå‰©ä¸‹NERDTreeåˆ™å…³é—­vim
" autocmd bufenter * if (winnr("$") == 1 && exists("b:NERDTree") && b:NERDTree.isTabTree()) | q | endif
" åˆ‡æ¢ NERDTree
noremap  <silent> <F2> <Esc>:call NERDTreeToggler()<CR>
noremap! <silent> <F2> <Esc>:call NERDTreeToggler()<CR>
function! NERDTreeToggler()
  if (exists("t:NERDTreeBufName") && bufwinnr(t:NERDTreeBufName) != -1)
    exe ":NERDTreeClose"
  else
    if (expand("%:t") != '')
      exe ":NERDTreeFind"
    else
      exe ":NERDTreeToggle"
    endif
  endif
endfunction
" ]]]

" nerdtree-git-plugin
" [[[
let g:NERDTreeIndicatorMapCustom = {
            \ "Modified"  : "âœ¹",
            \ "Staged"    : "âœš",
            \ "Untracked" : "âœ­",
            \ "Renamed"   : "âœ",
            \ "Unmerged"  : "â•",
            \ "Deleted"   : "âœ–",
            \ "Dirty"     : "âœ—",
            \ "Clean"     : "âœ”ï¸",
            \ 'Ignored'   : 'â˜’',
            \ "Unknown"   : "?"
            \ }
" ]]]

" rainbow
" [[[
let g:rainbow_active = 1
let g:rainbow_conf = {
            \   'guifgs': ['royalblue3', 'darkorange3', 'seagreen3', 'firebrick'],
            \   'ctermfgs': ['lightblue', 'lightyellow', 'lightcyan', 'lightmagenta'],
            \   'operators': '_,_',
            \   'parentheses': ['start=/(/ end=/)/ fold', 'start=/\[/ end=/\]/ fold', 'start=/{/ end=/}/ fold'],
            \   'separately': {
            \       '*': {},
            \       'tex': {
            \           'parentheses': ['start=/(/ end=/)/', 'start=/\[/ end=/\]/'],
            \       },
            \       'lisp': {
            \           'guifgs': ['royalblue3', 'darkorange3', 'seagreen3', 'firebrick', 'darkorchid3'],
            \       },
            \       'vim': {
            \           'parentheses': ['start=/(/ end=/)/', 'start=/\[/ end=/\]/', 'start=/{/ end=/}/ fold', 'start=/(/ end=/)/ containedin=vimFuncBody', 'start=/\[/ end=/\]/ containedin=vimFuncBody', 'start=/{/ end=/}/ fold containedin=vimFuncBody'],
            \       },
            \       'html': {
            \           'parentheses': ['start=/\v\<((area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)[ >])@!\z([-_:a-zA-Z0-9]+)(\s+[-_:a-zA-Z0-9]+(\=("[^"]*"|'."'".'[^'."'".']*'."'".'|[^ '."'".'"><=`]*))?)*\>/ end=#</\z1># fold'],
            \       },
            \       'css': 0,
            \   }
            \}
" ]]]

" sideways.vim
" [[[
nnoremap <C-h>  :SidewaysLeft<CR>
nnoremap <C-l>  :SidewaysRight<CR>
" ]]]

" vim-argwrap
" [[[
noremap <silent> <Leader>aw <Esc>:ArgWrap<CR>
autocmd FileType vim let b:argwrap_line_prefix = '\'
autocmd FileType vim let b:argwrap_tail_indent_braces = '('
" ]]]

" vim-autoformat
" [[[
" ä¿å­˜æ–‡ä»¶æ—¶ FORMAT
let g:autoformat_enabled = 1
noremap <C-p> <Esc>:call ToggleAutoformat()<CR>
autocmd BufWrite * if g:autoformat_enabled | exec "Autoformat" | endif
function! ToggleAutoformat()
    if g:autoformat_enabled
        let g:autoformat_enabled = 0
        echo "Autoformat disabled"
    else
        let g:autoformat_enabled = 1
        echo "Autoformat enabled"
    endif
endfunction
noremap  <F6> <Esc>:Autoformat<CR>
noremap! <F6> <Esc>:Autoformat<CR>
let g:autoformat_autoindent = 0
let g:autoformat_retab = 0
let g:autoformat_remove_trailing_space = 0
" ]]]

" vim-bookmarks
" [[[
" é‡æ–°å®šä¹‰æŒ‰é”®æ˜ å°„
let g:bookmark_no_default_key_mappings = 1
nmap <Leader>mm <Plug>BookmarkToggle
nmap <Leader>mi <Plug>BookmarkAnnotate
nmap <Leader>ma <Plug>BookmarkShowAll
nmap <Leader>mj <Plug>BookmarkNext
nmap <Leader>mk <Plug>BookmarkPrev
nmap <Leader>mx <Plug>BookmarkClearAll
" æ˜¾ç¤º
highlight BookmarkSign ctermbg=NONE ctermfg=160
highlight BookmarkLine ctermbg=194 ctermfg=NONE
let g:bookmark_sign = 'âš‘'
let g:bookmark_highlight_lines = 1
" ç¼“å­˜åœ°å€
let g:bookmark_auto_save_file = $HOME . '/.vim/.cache/vim_bookmarks'
" ]]]

" vim-commentary
" [[[
autocmd FileType python,shell,coffee setlocal commentstring=#\ %s
autocmd FileType java,c,cpp          setlocal commentstring=//\ %s
" ]]]

" vim-easy-align
" [[[
xmap ga <Plug>(EasyAlign)
nmap ga <Plug>(EasyAlign)
" ]]]

" vim-exchange
" [[[
noremap  cx  <Plug>(Exchange)
vnoremap X   <Plug>(Exchange)
noremap  cxc <Plug>(ExchangeClear)
noremap  cxx <Plug>(ExchangeLine)
let g:exchange_no_mappings = 1
" ]]]

" vim-gutentags
" [[[
" gutentags æœç´¢å·¥ç¨‹ç›®å½•çš„æ ‡å¿—ï¼Œç¢°åˆ°è¿™äº›æ–‡ä»¶/ç›®å½•åå°±åœæ­¢å‘ä¸Šä¸€çº§ç›®å½•é€’å½’
let g:gutentags_project_root = ['.root', '.svn', '.git', '.hg', '.project','.idea']

" æ‰€ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶çš„åç§°
let g:gutentags_ctags_tagfile = '.tags'

" é»˜è®¤ä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹äº§ç”Ÿ .tags æ–‡ä»¶
" å°†è‡ªåŠ¨ç”Ÿæˆçš„ tags æ–‡ä»¶å…¨éƒ¨æ”¾å…¥ ~/.vim/tags ç›®å½•ä¸­ï¼Œé¿å…æ±¡æŸ“å·¥ç¨‹ç›®å½•
" gitbash è·¯å¾„ä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥åœ¨å½“å‰æ–‡ä»¶å¤¹ç”Ÿæˆ
" let s:vim_tags = expand('~/.vim/.cache/tags')
" let g:gutentags_cache_dir = s:vim_tags

" é…ç½® ctags çš„å‚æ•°
let g:gutentags_ctags_extra_args =  ['--fields=+niazS', '--extra=+q']
let g:gutentags_ctags_extra_args += ['--c++-kinds=+px']
let g:gutentags_ctags_extra_args += ['--c-kinds=+px']
" ]]]

" vim-header
" [[[
let g:header_auto_add_header = 0
let g:header_field_filename = 0
let g:header_field_author = 'clouduan'
let g:header_field_author_email = ''
let g:header_alignment = 0
let g:header_field_timestamp = 1
let g:header_field_modified_timestamp = 1
let g:header_field_modified_by = 1
let g:header_field_timestamp_format = '%Y-%m-%d %H:%M:%S'
" ]]]
"
" vim-javascript
" [[[
let javascript_enable_domhtmlcss = 1
let g:javascript_plugin_flow = 1
" ]]]

" vim-json
" [[[
" é¿å…å¼•å·è¢«éšè—
let g:vim_json_syntax_conceal = 0
" ]]]

" vim-keysound
" [[[
let g:keysound_enable = 1
let g:keysound_theme = 'default'
let g:keysound_py_version = 3
let g:keysound_volume = 1000
" ]]]

" vim-mark
" [[[
" å’Œ visual-star-search æœ‰ <Leader>* å†²çª(MarkSet)
" ä»¥åŠå…¶ä»–å†²çª
" è§£é™¤ <Leader>*
nmap <Plug>DisableMarkSearchCurrentNext <Plug>MarkSearchCurrentNext
" è§£é™¤ <Leader>r
nmap <Plug>DisableMarkRegex <Plug>MarkRegex
" è§£é™¤ <Leader>n
nmap <Plug>DisableMarkClear <Plug>MarkClear
" è§£é™¤ <Leader>/
nmap <Plug>DisableMarkSearchAnyNext <Plug>MarkSearchAnyNext
" è§£é™¤ <Leader>?
nmap <Plug>DisableMarkSearchAnyPrev <Plug>MarkSearchAnyPrev
" è§£é™¤ *
nmap <Plug>DisableMarkSearchNext <Plug>MarkSearchNext
" è§£é™¤ #
nmap <Plug>DisableMarkSearchPrev <Plug>MarkSearchPrev
" é‡æ–°å®šä¹‰æ˜ å°„
nmap <Leader>ms                  <Plug>MarkSet
" ]]]

" vim-markdown
" [[[
let g:vim_markdown_conceal = 0
" é¿å…æ ‡å¿—ç¬¦å·è¢«éšè—
let g:tex_conceal = ""
let g:vim_markdown_math = 1
" ]]]

" vim-matchup
" [[[
" è·³è½¬æˆå¯¹æ‹¬å·ï¼Œæ­¤å¤„ä¸èƒ½ç”¨éé€’å½’æ¨¡å¼ï¼Œå› ä¸ºåœ¨ mathit.vim é‡Œç”¨äº†éé€’å½’æ˜ å°„
nmap M %
autocmd FileType vim let b:match_words =
            \ '\<fu\%[nction]\>:\<retu\%[rn]\>:\<endf\%[unction]\>,' .
            \ '\<\(wh\%[ile]\|for\)\>:\<brea\%[k]\>:\<con\%[tinue]\>:\<end\(w\%[hile]\|fo\%[r]\)\>,' .
            \ '\<if\>:\<el\%[seif]\>:\<en\%[dif]\>,' .
            \ '\<try\>:\<cat\%[ch]\>:\<fina\%[lly]\>:\<endt\%[ry]\>,' .
            \ '\<aug\%[roup]\s\+\%(END\>\)\@!\S:\<aug\%[roup]\s\+END\>'
autocmd FileType python let b:match_words =
            \ '\<if\>:\<el\%[seif]\>,' .
            \ '\<for\>:\<continue\>:\<break\>,' .
            \ '\<while\>:\<continue\>:\<break\>,' .
            \ '\<def\>:\<return\>,' .
            \ '\<try\>:\<except\>:\<finally\>'
" \< \> æ ‡å¿—å•è¯çš„è¾¹ç•Œï¼Œæ­¤å¤„ ; å·¦è¾¹ä¸åˆ«çš„å­—ç¬¦ç›´æ¥æ¥è§¦
autocmd FileType javascript let b:match_words =
            \ '=:;,' .
            \ '\<if\>:\<else\>,' .
            \ '\<for\>:\<continue\>:\<break\>,' .
            \ '\<while\>:\<continue\>:\<break\>,' .
            \ '\<function\>:\<return\>,' .
            \ '\<switch\>:\<case\>:\<default\>,' .
            \ '\<\\\*\>:\<\*\\\>'
autocmd FileType c,cpp let b:match_words =
            \ '=:;,' .
            \ '\<if\>:\<else\>,' .
            \ '\<for\>:\<continue\>:\<break\>,' .
            \ '\<do\>:\<while\>:\<continue\>:\<break\>,' .
            \ '\<switch\>:\<case\>:\<default\>,' .
            \ '\<\\\*\>:\<\*\\\>'
" ]]]

" vim-move
" [[[
let g:move_map_keys = 0
let g:move_auto_indent = 1
vmap J <Plug>MoveBlockDown
vmap K <Plug>MoveBlockUp
nmap J <Plug>MoveLineDown
nmap K <Plug>MoveLineUp
"]]]

" vim-multiple-cursor
" [[[
let g:multi_cursor_use_default_mapping=0
let g:multi_cursor_start_word_key      = '<C-n>'
let g:multi_cursor_select_all_word_key = '<A-n>'
let g:multi_cursor_start_key           = 'g<C-n>'
let g:multi_cursor_select_all_key      = 'g<A-n>'
let g:multi_cursor_next_key            = '<C-n>'
let g:multi_cursor_prev_key            = '<C-p>'
let g:multi_cursor_skip_key            = '<C-x>'
let g:multi_cursor_quit_key            = '<Esc>'
" ]]]

" vim-nerdtree-syntax-highlight
" [[[
let g:NERDTreeFileExtensionHighlightFullName = 1
let g:NERDTreeExactMatchHighlightFullName = 1
let g:NERDTreePatternMatchHighlightFullName = 1

let s:brown = "905532"
let s:aqua =  "3AFFDB"
let s:blue = "689FB6"
let s:darkBlue = "44788E"
let s:purple = "834F79"
let s:lightPurple = "834F79"
let s:red = "AE403F"
let s:beige = "F5C06F"
let s:yellow = "F09F17"
let s:orange = "D4843E"
let s:darkOrange = "F16529"
let s:pink = "CB6F6F"
let s:salmon = "EE6E73"
let s:green = "8FAA54"
let s:lightGreen = "31B53E"
let s:white = "FFFFFF"
let s:rspec_red = 'FE405F'
let s:git_orange = 'F54D27'

let g:NERDTreeExtensionHighlightColor = {} " this line is needed to avoid error
let g:NERDTreeExtensionHighlightColor['css'] = s:blue " sets the color of css files to blue

let g:NERDTreeExactMatchHighlightColor = {} " this line is needed to avoid error
let g:NERDTreeExactMatchHighlightColor['.gitignore'] = s:git_orange " sets the color for .gitignore files

let g:NERDTreePatternMatchHighlightColor = {} " this line is needed to avoid error
let g:NERDTreePatternMatchHighlightColor['.*_spec\.rb$'] = s:rspec_red " sets the color for files ending with _spec.rb
" ]]]

" vim-search-me
" [[[
noremap  <Leader>ss :<C-u>SearchCurrentText<CR>
vnoremap <Leader>sv :<C-u>SearchVisualText<CR>
noremap  <Leader>sm :Search<space>

let g:search = 'google'
let g:query = {
            \ 'google':'https://google.com/search\?q\={query}',
            \ 'github':'https://github.com/search\?q\={query}',
            \ 'stackoverflow':'https://stackoverflow.com/search\?q\={query}',
            \ 'bilibili':'http://search.bilibili.com/all\?keyword\={query}',
            \ 'askubuntu': 'https://askubuntu.com/search\?q\={query}',
            \ 'wikipedia': 'https://en.wikipedia.org/wiki/{query}',
            \ 'duckduckgo': 'https://duckduckgo.com/\?q\={query}',
            \ 'twitter-search': 'https://twitter.com/search/{query}',
            \ 'twitter-user': 'https://twitter.com/{query}',
            \ 'reddit':'https://www.reddit.com/search\?q\={query}',
            \ 'youtube':'https://www.youtube.com/results\?search_query\={query}\&page\=\&utm_source\=opensearch',
            \ 'zhihu':'https://www.zhihu.com/search\?q\={query}',
            \ 'baidu':'https://www.baidu.com/s\?ie\=UTF-8\&wd\={query}'
            \}
" ]]]

" vim-signify
" [[[
" è·³è½¬
nmap <C-right> <Plug>(signify-next-hunk)
nmap <C-left>  <Plug>(signify-prev-hunk)
" ! æ”¹æˆ ~
let g:signify_sign_change = '~'
" ä¸¤æ¬¡æŒ‰é”®é—´éš”å¤§äº updatetime æ—¶è‡ªåŠ¨å†™å…¥ç£ç›˜å¹¶æ˜¾ç¤ºçŠ¶æ€
let g:signify_cursorhold_normal = 1
let g:signify_cursorhold_insert = 1
" " é«˜äº®è¡Œ
highlight DiffAdd           cterm=bold ctermbg=none ctermfg=156
highlight DiffDelete        cterm=bold ctermbg=none ctermfg=167
highlight DiffChange        cterm=bold ctermbg=none ctermfg=227
" é«˜äº®ä¾§æ ç¬¦å·
highlight SignifySignAdd    cterm=bold ctermbg=38   ctermfg=119
highlight SignifySignDelete cterm=bold ctermbg=38   ctermfg=167
highlight SignifySignChange cterm=bold ctermbg=38   ctermfg=227
" VCS
let g:signify_vcs_list = [ 'git']
" Windows ä¸‹ VCS çš„è·¯å¾„è®¾ç½®
if !has('unix')
    let g:signify_vcs_cmds = {
                \ 'git': '"C:\Program Files (x86)\Git\bin\git.exe" diff --no-color --no-ext-diff -U0 -- %f'
                \ }
endif
" ]]]

" vim-startify
" [[[
noremap <silent> <Space> <Esc>:Startify<CR>
" ]]]

" vim-table-mode
" [[[
" for Markdown
let g:table_mode_corner = '|'
" ]]]

" vim-textobj-user
" [[[
" datetime
call textobj#user#plugin('datetime', {
            \   'date': {
            \     'pattern': '\<\d\d\d\d-\d\d-\d\d\>',
            \     'select': ['ad', 'id'],
            \   },
            \   'time': {
            \     'pattern': '\<\d\d:\d\d:\d\d\>',
            \     'select': ['at', 'it'],
            \   },
            \ })
" ]]]

" vim-youdao-translater
" [[[
vnoremap <silent> <Leader>tv :<C-u>Ydv<CR>
nnoremap <silent> <Leader>tt :<C-u>Ydc<CR>
noremap  <silent> <Leader>te <Esc>:Yde<CR>
" ]]]

" undotree
" [[[
noremap  <silent> <F3> <Esc>:UndotreeToggle<CR>
noremap! <silent> <F3> <Esc>:UndotreeToggle<CR>
let g:undotree_WindowLayout = 2
let g:undotree_SetFocusWhenToggle = 1
let g:undotree_ShortIndicators = 1
let g:undotree_SplitWidth = 25
" ]]]
" ]]]

" ======================================================================
" GVIM Settings
" ======================================================================
" [[[
" gvim ä¸‹ TODO: å¾…éªŒè¯
if has('gui_running')
    inoremap <S-CR> <Esc>o
    inoremap <C-CR> <Esc>O
    "set guifont=DejaVu\ Sans\ Mono\ for\ Powerline:h12
    "set guifont=Fira_Code:h12
endif
" ]]]
"
" =====================================================================
" Cheet Sheet
" =====================================================================
" [[[
" æ˜“æ··æ·†å¿«æ·é”®æ€»è§ˆ
" [[[
" n      <S-h>                  è¡Œé¦–
" n      <S-j>             :<vim-move> move up
" n      <S-k>             :<vim-move> move down
" n      <S-l>             è¡Œå°¾
" n      <C-j>             è·³è½¬å‡½æ•°å®šä¹‰
" n      <C-k>             è·³è½¬å¸®åŠ©
" n      <C-h>             :<vim-sideways> SidewaysLeft<CR>
" n      <C-l>             :<vim-sideways> SidewaysRight<CR>
" n      <C-left>          <Plug>(signify-prev-hunk)
" n      <C-right>         <Plug>(signify-next-hunk)
" n      <C-up>            <Plug>(ale_previous_wrap)
" n      <C-down>          <Plug>(ale_next_wrap)
" n      <M-h>             <Esc><C-w>h
" n      <M-j>             <Esc><C-w>j
" n      <M-k>             <Esc><C-w>k
" n      <M-l>             <Esc><C-w>l
" n      <M-up>            <C-w>+
" n      <M-down>          <C-w>-
" n      <M-left>          <C-w>10<
" n      <M-right>         <C-w>10>
" n      <Leader>ff        <Esc>:LeaderfFile<CR>
" n      <Leader>ft        <Esc>:LeaderfBufTagAll<CR>
" n      <Leader>fb        <Esc>:LeaderfBufferAll<CR>
" n      <Leader>aw        <Esc>:ArgWrap<CR>
" n      <Leader>ms        <Plug>MarkSet
" n      <Leader>mm        <Plug>BookmarkToggle
" n      <Leader>mi        <Plug>BookmarkAnnotate
" n      <Leader>ma        <Plug>BookmarkShowAll
" n      <Leader>mj        <Plug>BookmarkNext
" n      <Leader>mk        <Plug>BookmarkPrev
" n      <Leader>mx        <Plug>BookmarkClearAll
" n      <Leader>ss        :<C-u>SearchCurrentText<CR>
" n      <Leader>ss        :<C-u>SearchCurrentText<CR>
" v      <Leader>sv        :<C-u>SearchVisualText<CR>
" n      <Leader>sm        :Search<space>
" v      <Leader>sv        :<C-u>SearchVisualText<CR>
" n      <Leader>sm        :Search<space>
" v      <Leader>tv        :Ydv<CR>
" n      <Leader>tc        :Ydc<CR>
" n      <Leader>te        sc>:Yde<CR>
" ]]]

" æ’ä»¶å‘½ä»¤å°è®¡
" [[[
" gv.vim
" [[[
" GV: æŸ¥çœ‹ commits
" GV!: åªä¸å½“å‰æ–‡ä»¶æœ‰å…³çš„ commits
" ]]]
"
" vim-fugitive
" [[[
" Git: åŒä¸€åˆ‡ git å‘½ä»¤ï¼ŒåŠ  ! å¯ä»¥åœ¨ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶é‡Œæ˜¾ç¤ºç»“æœ Git add, Git log, Git rm ...
" Gblame: = Git blame
" Gcommit: = Git commit
" Gdelete: = Git delete
" Gdiff: Gvdiff, Gsdiff. å¯ä»¥é€‰æ‹©èŒƒå›´æˆ–è€…ç›´æ¥æ‰§è¡Œ diffget/diffput å‘½ä»¤æ¶ˆé™¤å·®å¼‚; ä¹Ÿå¯ç”¨ Gread/Gwrite, ä½†æ˜¯æ˜¯å…¨éƒ¨æ›´æ–°
" Gfetch:
" Ggrep: Ggrep 'find me'
" Glog: Git log
" Gmove: ç§»åŠ¨æˆ–è€…é‡å‘½å
" Gpull:
" Gpush:
" Gstatus: = Git status, åœ¨ status çª—å£å¯ä»¥ç”¨ - é”®å¿«é€Ÿ add; <Enter> æ‰“å¼€å…‰æ ‡ä¸‹æ–‡ä»¶; p ç›¸å½“äº git add --patch; C ä¼šè°ƒç”¨ Gcommit(ç”±äºæœ¬äººé”®æ˜ å°„çš„åŸå› ï¼ŒC è¢«æ˜ å°„ä¸ºå…¶ä»–é”®äº†)
" Gread: = Git checkout -- filename
" Gwrite: = Git add
" ]]]
"
" vim-surround
" [[[
" ä¸€èˆ¬ç”¨æ³•: ys**; cs**; ds*
" ç«¯å¢åŠ ç©ºæ ¼: ys*<Space><Space>
" ]]]
"
" ]]]
" ]]]

